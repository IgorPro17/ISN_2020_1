## Отчет по практической работе №4
**Цель работы:** изучение методов работы компонентов PWA приложений.

**1. Service Worker**

В ходе выполнения данного задания ознакомились с работой Service Worker. Затем было изучено тестовое приложение sw-test, код которого находится в ветке ToolsPWApplication.

**Ответы на вопросы:**
- Какие технологии лежат в основе Service Worker?

В основе Service Worker лежит JavaScript так как он представляет собой JavaScript-файл, который может контролировать веб-страницу/сайт, с которым он ассоциируется, перехватывать и модифицировать запросы навигации и ресурсов, очень гибко кешировать ресурсы, для того чтобы предоставить полный контроль над тем, как приложение ведет себя в определенных ситуациях (например, когда сеть не доступна).
- Как работает Service Worker?

Service worker запускается в контексте worker'ов, поэтому он не имеет доступа к DOM и работает в потоке отдельном от основного потока JavaScript, управляющего вашим приложением, а следовательно — не блокирует его. Он призван быть полностью асинхронным; как следствие, синхронные API, такие как XHR и localStorage, в Service Worker'е использовать нельзя.
Service worker сначала регистрируется с помощью метода ServiceWorkerContainer.register(). В случае успешной регистрации service worker будет загружен клиентом и попытается установиться/активироваться для всех URL, доступных пользователю, или только для указанного вами подмножества.
Service Worker будет следовать следующему жизненному циклу:
1) Загрузка
2) Установка
3) Активация
- Возможно ли проксирование запросов с разных удаленных серверов с разными IP адресами? Почему и как можно реализовать?

При статическом перенаправлении портов нельзя перенаправлять один порт на несколько IP-адресов, то есть порт может соответствовать только одному IP-адресу. Таким образом, невозможно, например, сконфигурировать несколько Web-серверов с разными IP-адресами — для этого придется менять порт Web-сервера по умолчанию и при обращении по 80-му порту в настройке маршрутизатора в качестве Private Port указывать измененный порт Web-сервера.
- Сохраняется ли проксированный контент? Как настроить сохранение запросов в ServiceWoker?

Если запрос выполняется впервые, Service Worker дает ему дойти до сервера и сохраняет полученный ответ. При последующем таком запросе скрипт уже сам отдаст данные из кэша. Кроме того, можно использовать IndexedDB, LocalStorage и sessionStorage для сохранения контента.
- Какие есть ограничения в работе Service Woker?

Когда пользователь впервые запросит доступ к сайту/странице, контролируемой Service Worker'ом, тот моментально будет загружен. После этого он будет загружаться каждые 24 часа или около того. Он может загружаться и чаще, но он должен загружаться как минимум каждые 24 часа, чтобы предотвратить использование старой версии кода клиентом.

**2. IndexedDB**

В ходе выполнения данного задания ознакомились с IndexedDB. После чего повторили руководство по созданию простого веб-приложения, работающего с IndexedDB, код которого находится в ветке ToolsPWApplication.

**Ответы на вопросы:**

- Каким типом хранилища является IndexedDB?

IndexedDB — это способ постоянного хранения данных внутри клиентского браузера, другими словами, это NOSQL хранилище на стороне клиента. Что позволяет создавать веб-приложения с богатыми возможностями обращения к данным независимо от доступности сети, ваши приложения могут работать как онлайн, так и офлайн.
- Какая последовательность работы с хранилищем?

Обычная последовательность шагов при работе с IndexedDB:
1 Открыть базу данных.
2 Создать хранилище объектов в базе данных, над которой будут выполняться операции. 
3 Запустить транзакцию и выдать запрос на выполнение какой-либо операции с базой данных, например, добавление или извлечение данных.
4 Ждать завершения операции, "слушая" событие DOM, на которое должен быть установлен обработчик.
5 Сделать что-то с результатами (которые могут быть найдены в возвращаемом по запросу объекте).
- Какой жизненный цикл хранилища?

Выполнение операций, использующих IndexedDB происходит асинхронно, т.е. не блокирует приложение.
- Будет ли доступна информация из хранилища при закрытии веб-приложения? Если нет – какой тип хранилища надо использовать?

Будет так как база данных хранится локально и поэтому при отсутствии сети пользователь может получить эти локально сохраненные данные.
- Будет ли доступно хранилище двум одновременно открытым экземплярам веб-приложения? Почему?

Транзакции типа readwrite не могут иметь доступ к хранилищу, если оно занято, а транзакции readonly могут иметь доступ к хранилищу, так как они не мешают друг другу.


**3. LocalStorage, sessionStorage**

В ходе выполнения данного задания ознакомились с LocalStorage, sessionStorage. После чего выполнили следующее задание: «Создайте поле textarea, значение которого будет автоматически сохраняться при каждом его изменении. Когда пользователь закроет страницу и потом откроет её заново он должен увидеть последнее введённое значение.» Код задания находится в ветке ToolsPWApplication.

**Ответы на вопросы:**

- Каким типом хранилища является LocalStorage и sessionStorage?

LocalStorage и sessionStorage позволяют хранить данные в браузере типом ключ/значение.
- Какая последовательность работы с хранилищем?

1 Сохранить пару/ключ значение: setItem(key, value)
2 Получить данные по ключу key: getItem(key)
3 Если нужно удалить данные с ключом key: removeItem(key)
- Какой жизненный цикл хранилища?

Данные, которые записаны в LocalStorage и sessionStorage, сохраняются после обновления страницы (в случае sessionStorage) и даже после перезапуска браузера (при использовании localStorage).
- Будет ли доступна информация из хранилища при закрытии веб-приложения? Если нет – какой тип хранилища надо использовать?

LocalStorage «Переживает» перезапуск браузера
sessionStorage «Переживает» перезагрузку страницы (но не закрытие вкладки)
- Будет ли доступно хранилище двум одновременно открытым экземплярам веб-приложения? Почему?

Будет поскольку хранилище привязывается к источнику (домен/протокол/порт).


**4. Push Notification**

В ходе выполнения данного задания ознакомились с работой уведомлений. После чего дополнили разработанное приложение в практическом задании push уведомлениями согласно следующих требований к ним:
-	случайное время уведомления;
-	случайный текст на уведомлении;
-	уведомления являются периодичными;
-	уведомления хранятся в локально. 

Код находится в ветке ToolsPWApplication.

Пример push уведомления, а также локальное хранение уведомлений продемонстрировано на рисунках ниже.

**Пример push уведомления**

![](https://sun9-39.userapi.com/POqMHI_SLvEP74QAKdmtSa9VENfIf5PlhBAldg/R2up9NFsvC8.jpg)

**Демонстрация локального хранения уведомлений, которые выводятся в консоль**

![](https://sun9-16.userapi.com/58_qdsFUF2tNgSGZbBiGMiC9bw-HfCCYdyX6hw/8ke6XeSdLc8.jpg)
